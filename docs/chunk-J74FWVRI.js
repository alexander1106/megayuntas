import{c as W,e as $,h as L,r as R}from"./chunk-VBC45PGF.js";import{a as N}from"./chunk-EWES4JOE.js";import{a as O,c as H}from"./chunk-B24EO72Z.js";import{$a as f,Bb as E,Ma as l,Na as w,P as V,U as F,Za as M,_,cc as D,db as t,dc as B,eb as i,fb as c,fc as y,ga as p,ha as x,ib as v,jb as d,kb as m,pa as b,sb as a,tb as g,ub as S,vb as j,xb as C,yb as U,zb as I}from"./chunk-HWFM7EIN.js";import{a as T,b as z}from"./chunk-5FZOKLP6.js";var P=(()=>{class o{constructor(){this.usuarioId=null,this.confirmar=new b,this.cancelar=new b}confirmarEliminacion(){console.log("ID a eliminar:",this.usuarioId),this.usuarioId!==null&&this.confirmar.emit(this.usuarioId)}cancelarEliminacion(){this.cancelar.emit()}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=_({type:o,selectors:[["app-eliminar-usuarios-modal"]],inputs:{usuarioId:"usuarioId"},outputs:{confirmar:"confirmar",cancelar:"cancelar"},standalone:!0,features:[E],decls:13,vars:0,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"w-full","max-w-md","bg-white","rounded-lg","shadow-lg","p-6","text-center"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","rounded-full","bg-yellow-300","flex","items-center","justify-center"],[1,"text-white","text-3xl","font-bold"],[1,"text-2xl","font-bold","mb-6"],[1,"flex","justify-center","space-x-4"],[1,"px-6","py-2","bg-teal-500","text-white","rounded","hover:bg-teal-600","transition",3,"click"],[1,"px-6","py-2","bg-orange-400","text-white","rounded","hover:bg-orange-500","transition",3,"click"]],template:function(n,r){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),a(5,"i"),i()()(),t(6,"h2",5),a(7," \xBFEstas seguro eliminar este elemento? "),i(),t(8,"div",6)(9,"button",7),d("click",function(){return r.confirmarEliminacion()}),a(10," Aceptar "),i(),t(11,"button",8),d("click",function(){return r.cancelarEliminacion()}),a(12," Cancelar "),i()()()())},dependencies:[y]})}}return o})();var k=(()=>{class o{constructor(e){this.http=e,this.apiUrl=N.apiUrl}getAuthHeaders(){let e=localStorage.getItem("token")||"";return new O({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})}getUsuarios(){return this.http.get(`${this.apiUrl}/usuarios`,{headers:this.getAuthHeaders()})}crearUsuario(e){return this.http.post(`${this.apiUrl}/usuarios`,e,{headers:this.getAuthHeaders()})}actualizarUsuario(e){let n=this.getAuthHeaders(),r={id:e.id,nombres:e.nombres,apellidos:e.apellidos,email:e.email};return console.log("Datos a enviar:",r),this.http.put(`${this.apiUrl}/usuarios`,r,{headers:n})}eliminarUsuario(e){return this.http.post(`${this.apiUrl}/usuarios/eliminar?id=${e}`,{})}static{this.\u0275fac=function(n){return new(n||o)(F(H))}}static{this.\u0275prov=V({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var G=(()=>{class o{constructor(e){this.usuariosService=e,this.usuario={},this.usuarioEditado={id:"",nombres:"",apellidos:"",email:""},this.cerrar=new b,this.actualizado=new b}ngOnInit(){this.usuarioEditado={id:this.usuario.id,nombres:this.usuario.nombres||"",apellidos:this.usuario.apellidos||"",email:this.usuario.email||""},console.log("Usuario original:",this.usuario),console.log("Usuario editado (copia):",this.usuarioEditado)}cerrarModal(){this.cerrar.emit()}guardarUsuario(){if(!this.usuarioEditado.nombres.trim()||!this.usuarioEditado.apellidos.trim()||!this.usuarioEditado.email.trim()){alert("Todos los campos son obligatorios.");return}console.log("Datos del usuario a actualizar:",this.usuarioEditado),this.usuariosService.actualizarUsuario(this.usuarioEditado).subscribe({next:e=>{console.log("Usuario actualizado exitosamente:",e),this.actualizado.emit(),this.cerrarModal()},error:e=>{console.error("Error al actualizar usuario:",e),alert("Error al actualizar usuario: "+(e.error?.message||e.message))}})}static{this.\u0275fac=function(n){return new(n||o)(w(k))}}static{this.\u0275cmp=_({type:o,selectors:[["app-editar-usuarios-modal"]],inputs:{usuario:"usuario"},outputs:{cerrar:"cerrar",actualizado:"actualizado"},standalone:!0,features:[E],decls:24,vars:3,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","overflow-auto","bg-black","bg-opacity-50"],[1,"w-full","max-w-lg","my-4","bg-gray-200","rounded-lg","shadow-lg","max-h-[70vh]","overflow-y-auto"],[1,"p-3","border-b","border-gray-300"],[1,"text-3xl","font-bold","text-black"],[1,"p-4","space-y-4"],[1,"flex","items-center"],[1,"w-32","font-medium","text-black"],["type","text",1,"flex-1","border","border-gray-300","rounded","px-2","py-1","bg-white",3,"ngModelChange","ngModel"],[1,"flex-1","flex"],[1,"flex","justify-end","space-x-4","mt-6"],[1,"px-6","py-2","bg-teal-500","text-white","rounded","hover:bg-teal-600","transition",3,"click"],[1,"px-6","py-2","bg-orange-500","text-white","rounded","hover:bg-orange-600","transition",3,"click"]],template:function(n,r){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),a(4,"Editar Usuario"),i()(),t(5,"div",4)(6,"div",5)(7,"label",6),a(8,"Nombre :"),i(),t(9,"input",7),I("ngModelChange",function(u){return U(r.usuarioEditado.nombres,u)||(r.usuarioEditado.nombres=u),u}),i()(),t(10,"div",5)(11,"label",6),a(12,"Apellidos :"),i(),t(13,"div",8)(14,"input",7),I("ngModelChange",function(u){return U(r.usuarioEditado.apellidos,u)||(r.usuarioEditado.apellidos=u),u}),i()()(),t(15,"div",5)(16,"label",6),a(17,"Email: "),i(),t(18,"input",7),I("ngModelChange",function(u){return U(r.usuarioEditado.email,u)||(r.usuarioEditado.email=u),u}),i()(),t(19,"div",9)(20,"button",10),d("click",function(){return r.guardarUsuario()}),a(21," Guardar "),i(),t(22,"button",11),d("click",function(){return r.cerrarModal()}),a(23," Cancelar "),i()()()()()),n&2&&(l(9),C("ngModel",r.usuarioEditado.nombres),l(5),C("ngModel",r.usuarioEditado.apellidos),l(4),C("ngModel",r.usuarioEditado.email))},dependencies:[y,R,W,$,L]})}}return o})();function J(o,h){if(o&1){let e=v();t(0,"tr")(1,"td",31),a(2),i(),t(3,"td",32),a(4),i(),t(5,"td",32),a(6),i(),t(7,"td",32),a(8),i(),t(9,"td",32),a(10),i(),t(11,"td",33)(12,"button",34),d("click",function(){let r=p(e).$implicit,s=m();return x(s.abrirModalEditar(r))}),c(13,"iconify-icon",35),i(),t(14,"button",36),d("click",function(){let r=p(e).$implicit,s=m();return x(s.abrirModalEliminar(r.id))}),c(15,"iconify-icon",37),i()()()}if(o&2){let e=h.$implicit;l(2),g(e.id),l(2),g(e.nombres),l(2),g(e.apellidos),l(2),g(e.email),l(2),g(e.idRol)}}function K(o,h){if(o&1){let e=v();t(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41),c(4,"iconify-icon",42),i(),t(5,"div",43)(6,"h3",44),a(7),i(),t(8,"p",45),a(9),i()()(),t(10,"div",46)(11,"button",47),d("click",function(){let r=p(e).$implicit,s=m();return x(s.abrirModalEditar(r))}),c(12,"iconify-icon",48),i(),t(13,"button",49),d("click",function(){let r=p(e).$implicit,s=m();return x(s.abrirModalEliminar(r.id))}),c(14,"iconify-icon",50),i()()(),t(15,"div",51)(16,"div",52)(17,"span",53),a(18,"Email:"),i(),t(19,"span",54),a(20),i()(),t(21,"div",55)(22,"span",56),a(23,"Perfil:"),i(),t(24,"span",57),a(25),i()()()()}if(o&2){let e=h.$implicit;l(7),j("",e.nombres," ",e.apellidos,""),l(2),S("ID: ",e.id,""),l(11),g(e.email),l(5),S(" ",e.idRol," ")}}function Q(o,h){o&1&&(t(0,"div",58),c(1,"iconify-icon",59),t(2,"p",60),a(3,"No hay usuarios registrados"),i()())}function X(o,h){if(o&1){let e=v();t(0,"app-editar-usuarios-modal",61),d("cerrar",function(){p(e);let r=m();return x(r.cerrarModalEditar())}),i()}if(o&2){let e=m();f("usuario",e.usuarioSeleccionado)}}function Y(o,h){if(o&1){let e=v();t(0,"app-eliminar-usuarios-modal",62),d("confirmar",function(r){p(e);let s=m();return x(s.eliminarUsuario(r))})("cancelar",function(){p(e);let r=m();return x(r.cerrarModalEliminar())}),i()}if(o&2){let e=m();f("usuarioId",e.usuarioIdAEliminar)}}var ve=(()=>{class o{constructor(e){this.usuariosService=e,this.usuarios=[],this.rolesMap={3:"Usuario"},this.mostrarModalAgregar=!1,this.mostrarModalEditar=!1,this.mostrarModalEliminar=!1,this.usuarioSeleccionado=null,this.usuarioIdAEliminar=null,this.idRol="Usuario"}ngOnInit(){this.cargarUsuarios()}cargarUsuarios(){this.usuariosService.getUsuarios().subscribe({next:e=>{console.log("Datos recibidos del servicio:",e),this.usuarios=e.map(n=>z(T({},n),{idRol:this.rolesMap[n.idRol]||n.idRol})),console.log("Usuarios procesados:",this.usuarios)},error:e=>console.error("Error al cargar usuarios",e)})}trackByUsuarioId(e,n){return n.id}abrirModalAgregar(){this.mostrarModalAgregar=!0}cerrarModalAgregar(){this.mostrarModalAgregar=!1,this.cargarUsuarios()}abrirModalEditar(e){this.usuarioSeleccionado=T({},e),this.mostrarModalEditar=!0}cerrarModalEditar(){this.mostrarModalEditar=!1,this.usuarioSeleccionado=null,this.cargarUsuarios()}abrirModalEliminar(e){this.usuarioIdAEliminar=e,this.mostrarModalEliminar=!0}cerrarModalEliminar(){this.mostrarModalEliminar=!1,this.usuarioIdAEliminar=null}eliminarUsuario(e){if(e==null||e===void 0){console.error("ID inv\xE1lido para eliminaci\xF3n");return}this.usuariosService.eliminarUsuario(e).subscribe({next:()=>{console.log(`Usuario con ID ${e} eliminado`),this.cerrarModalEliminar(),this.cargarUsuarios()},error:n=>{console.error("Error al eliminar Usuario:",n)}})}static{this.\u0275fac=function(n){return new(n||o)(w(k))}}static{this.\u0275cmp=_({type:o,selectors:[["app-usuarios"]],standalone:!0,features:[E],decls:47,vars:7,consts:[[1,"bg-gray-100","w-full","min-h-screen","flex","flex-col"],[1,"flex-1","w-full","mt-2","p-1","md:p-2","relative","z-10"],[1,"max-w-screen","mx-5"],[1,"hidden","md:block"],[1,"grid","grid-cols-2","gap-4","bg-[#00796B]","px-2","py-1"],[1,"flex-col","md:flex-row","flex","items-center"],[1,"text-2xl","md:text-2xl","font-bold","text-white"],[1,"flex-col","md:flex-row","flex","items-right","justify-end"],["for","buscar",1,"text-sm","flex","items-center","font-medium","text-white","mr-2","ml-5","whitespace-nowrap"],["id","buscar","type","text","placeholder","",1,"border","border-gray-300","rounded","px-3","py-1","w-full","max-w-xs","focus:outline-none","focus:ring-2","focus:ring-teal-500"],[1,"md:hidden","mb-6","relative","z-10","bg-gray-100"],[1,"mb-4","bg-gray-100","pt-2"],[1,"text-xl","font-bold","text-gray-900"],[1,"space-y-4","bg-gray-100"],[1,"relative","z-10"],["id","buscar-mobile","type","text","placeholder","Buscar usuario...",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-3","pr-12","text-sm","focus:outline-none","focus:ring-2","focus:ring-teal-500","focus:border-transparent","bg-white","shadow-md","relative","z-10"],["icon","mdi:magnify",1,"absolute","right-4","top-1/2","transform","-translate-y-1/2","text-gray-400","text-xl","pointer-events-none","z-10"],[1,"bg-[#00796B]","shadow","overflow-hidden"],[1,"overflow-x-auto"],[1,"w-full","divide-y","divide-gray-200"],[1,""],[1,"px-2","py-2","text-center","text-xs","font-medium","text-white","w-auto"],[1,"px-3","md:px-6","py-2","text-center","text-xs","font-medium","text-white"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],[1,"md:hidden","space-y-4","relative","z-10","bg-gray-100","pb-6"],["class","bg-white rounded-lg shadow-sm border border-gray-200 p-4 relative z-10",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12 bg-gray-100",4,"ngIf"],[1,"md:hidden","text-center","py-2","text-xs","text-gray-500"],[3,"usuario","cerrar",4,"ngIf"],[3,"usuarioId","confirmar","cancelar",4,"ngIf"],[1,"px-2","text-center","whitespace-nowrap","w-auto","text-xs"],[1,"px-3","md:px-6","text-center","whitespace-nowrap","text-xs"],[1,"px-3","md:px-6","whitespace-nowrap","text-center","text-xs"],["aria-label","Editar",1,"inline-flex","items-center","p-1","rounded","hover:bg-gray-100","transition",3,"click"],["icon","mdi:square-edit-outline",1,"text-2xl","text-teal-600"],["aria-label","Eliminar",1,"inline-flex","items-center","p-1","rounded","hover:bg-gray-100","transition",3,"click"],["icon","mdi:delete-outline",1,"text-2xl","text-red-600"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","p-4","relative","z-10"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-blue-100","rounded-full","flex","items-center","justify-center","flex-shrink-0"],["icon","mdi:account-outline",1,"text-blue-600","text-xl"],[1,"min-w-0","flex-1"],[1,"font-semibold","text-gray-900","text-sm","truncate"],[1,"text-xs","text-gray-500"],[1,"flex","space-x-1","flex-shrink-0"],["aria-label","Editar",1,"p-2","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],["icon","mdi:square-edit-outline",1,"text-lg","text-teal-600"],["aria-label","Eliminar",1,"p-2","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],["icon","mdi:delete-outline",1,"text-lg","text-red-600"],[1,"space-y-2"],[1,"flex","items-start","justify-between","py-1","border-b","border-gray-100"],[1,"text-xs","font-medium","text-gray-500","flex-shrink-0"],[1,"text-sm","text-gray-900","text-right","ml-2","break-all"],[1,"flex","items-center","justify-between","py-1"],[1,"text-xs","font-medium","text-gray-500"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"text-center","py-12","bg-gray-100"],["icon","mdi:account-off-outline",1,"text-5xl","text-gray-400","mb-3"],[1,"text-gray-500","text-sm"],[3,"cerrar","usuario"],[3,"confirmar","cancelar","usuarioId"]],template:function(n,r){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h1",6),a(7," Usuarios"),i()(),t(8,"div",7)(9,"label",8),a(10,"Buscar:"),i(),c(11,"input",9),i()()(),t(12,"div",10)(13,"div",11)(14,"h1",12),a(15,"Usuarios"),i()(),t(16,"div",13)(17,"div",14),c(18,"input",15)(19,"iconify-icon",16),i()()(),t(20,"div",3)(21,"div",17)(22,"div",18)(23,"table",19)(24,"thead",20)(25,"tr")(26,"th",21),a(27,"ID"),i(),t(28,"th",22),a(29,"Nombre"),i(),t(30,"th",22),a(31,"Apellido"),i(),t(32,"th",22),a(33,"Email"),i(),t(34,"th",22),a(35,"Perfil"),i(),t(36,"th",22),a(37,"Acciones"),i()()(),t(38,"tbody",23),M(39,J,16,5,"tr",24),i()()()()(),t(40,"div",25),M(41,K,26,5,"div",26)(42,Q,4,0,"div",27),t(43,"div",28),a(44),i()()()(),M(45,X,1,1,"app-editar-usuarios-modal",29)(46,Y,1,1,"app-eliminar-usuarios-modal",30),i()),n&2&&(l(39),f("ngForOf",r.usuarios),l(2),f("ngForOf",r.usuarios)("ngForTrackBy",r.trackByUsuarioId),l(),f("ngIf",r.usuarios.length===0),l(2),S(" Mostrando ",r.usuarios.length," usuarios "),l(),f("ngIf",r.mostrarModalEditar),l(),f("ngIf",r.mostrarModalEliminar))},dependencies:[y,D,B,G,P]})}}return o})();export{ve as UsuariosComponent};
